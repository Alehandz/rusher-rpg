<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Demand Rusher</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body {
    font-family: 'Inter', sans-serif;
    background-color: #2c2f33;
    color: #dcdcdc;
}
.container-panel {
    background-color: #40444b;
    border-radius: 8px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}
.offer-row {
    display: grid;
    grid-template-columns: 2fr 1fr 1fr 1fr 1fr 1fr;
    align-items: center;
    padding: 8px;
    border-bottom: 1px solid #36393f;
}
.offer-row:last-child {
    border-bottom: none;
}
.tab-content {
    display: none;
}
.tab-content.active {
    display: block;
}
</style>
</head>
<body class="bg-[#2c2f33] min-h-screen flex flex-col items-center">

<div class="w-full max-w-5xl p-8 space-y-8">

<header class="flex justify-between items-center container-panel p-6">
    <div class="flex-grow flex flex-col items-center">
        <h1 class="text-4xl font-bold text-[#7289da]">Demand Rusher</h1>
        <nav class="flex-grow flex justify-center space-x-4 mt-4">
            <button data-view="market" class="tab-button bg-[#36393f] text-[#dcdcdc] font-bold py-2 px-6 rounded-md hover:bg-[#4a4d53] transition duration-200">
                Market
            </button>
            <button data-view="inventory" class="tab-button bg-[#36393f] text-[#dcdcdc] font-bold py-2 px-6 rounded-md hover:bg-[#4a4d53] transition duration-200">
                Inventory
            </button>
            <button data-view="crafting" class="tab-button bg-[#36393f] text-[#dcdcdc] font-bold py-2 px-6 rounded-md hover:bg-[#4a4d53] transition duration-200">
                Crafting
            </button>
            <button data-view="jobs" class="tab-button bg-[#36393f] text-[#dcdcdc] font-bold py-2 px-6 rounded-md hover:bg-[#4a4d53] transition duration-200">
                Job Offers
            </button>
            <button data-view="ranking" class="tab-button bg-[#36393f] text-[#dcdcdc] font-bold py-2 px-6 rounded-md hover:bg-[#4a4d53] transition duration-200">
                Ranking
            </button>
        </nav>
    </div>
    <div class="flex-shrink-0">
        <button id="gamemaster-btn" class="bg-[#f04747] text-white font-bold py-2 px-4 rounded-full hover:bg-[#c93d3d] transition duration-200 hidden">
            GameMaster Mode
        </button>
    </div>
</header>

<div class="main-content flex-grow p-4">
    <!-- Your tab views will be here -->
</div>

<script type="module">
// Firebase imports
import { initializeApp } from '../shared/firebase_config.js';
import { getAuth, onAuthStateChanged } from '../shared/utils.js';
import { initializeGame } from './player.js';

// Initialize Firebase
const app = initializeApp();
const auth = getAuth(app);

// Authentication & App Initialization
onAuthStateChanged(auth, async (user) => {
    if (!user) {
        window.location.href = 'login.html';
        return;
    }
    await initializeGame(user);
});

// Tab switching
document.querySelectorAll('.tab-button').forEach(button => {
    button.addEventListener('click', () => {
        const viewName = button.dataset.view;
        document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
        const view = document.getElementById(`${viewName}-view`);
        if (view) view.classList.add('active');

        document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('bg-[#7289da]', 'text-white'));
        button.classList.add('bg-[#7289da]', 'text-white');
    });
});

// Show GameMaster button if user is GM
const gameMasterId = 'AN2gz1aJecYOdoy6qiYiAST94JP2';
auth.onAuthStateChanged(user => {
    if (user?.uid === gameMasterId) {
        document.getElementById('gamemaster-btn').classList.remove('hidden');
    }
});
</script>

</body>
</html>

